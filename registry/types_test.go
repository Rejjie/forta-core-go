package registry

import (
	"encoding/hex"
	"math/big"
	"testing"

	"github.com/ethereum/go-ethereum/common"
	"github.com/forta-network/forta-core-go/security/eip712"
	"github.com/stretchr/testify/require"
)

func TestMakeScannerRegistrationInfo(t *testing.T) {
	r := require.New(t)

	info, err := MakeScannerRegistrationInfo(&eip712.ScannerNodeRegistration{
		Scanner:       common.HexToAddress("0xce46cd6748adf0736b1f7550231df88046ee9a58"),
		ScannerPoolId: big.NewInt(1),
		ChainId:       big.NewInt(1),
		Metadata:      "",
		Timestamp:     big.NewInt(1),
	}, []byte{})
	r.NoError(err)
	r.Equal(
		"7dfe7c4200000000000000000000000000000000000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000100000000000000000000000000ce46cd6748adf0736b1f7550231df88046ee9a580000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",
		hex.EncodeToString(info.TxData),
	)
}
